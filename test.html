<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test - IEEE Career Fair</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
</head>
<body>
    <div class="container mt-5">
        <h1>IEEE Career Fair - Test Page</h1>
        <p>This is a test page to verify the application is working.</p>
        
        <div class="row">
            <div class="col-md-6">
                <h3>Test File Upload</h3>
                <input type="file" id="testFile" accept=".xlsx,.xls" class="form-control">
                <button onclick="testFileRead()" class="btn btn-primary mt-2">Test File Read</button>
                <div id="testResult" class="mt-3"></div>
            </div>
            
            <div class="col-md-6">
                <h3>Test JavaScript</h3>
                <button onclick="testJavaScript()" class="btn btn-success">Test JavaScript</button>
                <div id="jsResult" class="mt-3"></div>
            </div>
        </div>
        
        <div class="mt-5">
            <h3>Sample Data Test</h3>
            <button onclick="createSampleData()" class="btn btn-info">Create Sample Data</button>
            <div id="sampleResult" class="mt-3"></div>
        </div>
    </div>

    <script>
        function testJavaScript() {
            document.getElementById('jsResult').innerHTML = 
                '<div class="alert alert-success">✅ JavaScript is working!</div>';
        }
        
        function testFileRead() {
            const fileInput = document.getElementById('testFile');
            const file = fileInput.files[0];
            
            if (!file) {
                document.getElementById('testResult').innerHTML = 
                    '<div class="alert alert-warning">Please select a file first</div>';
                return;
            }
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const data = new Uint8Array(e.target.result);
                    const workbook = XLSX.read(data, { type: 'array' });
                    const sheetName = workbook.SheetNames[0];
                    const worksheet = workbook.Sheets[sheetName];
                    const jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1 });
                    
                    document.getElementById('testResult').innerHTML = 
                        `<div class="alert alert-success">
                            ✅ File read successfully!<br>
                            Sheet: ${sheetName}<br>
                            Rows: ${jsonData.length - 1}<br>
                            Columns: ${jsonData[0] ? jsonData[0].length : 0}
                        </div>`;
                } catch (error) {
                    document.getElementById('testResult').innerHTML = 
                        `<div class="alert alert-danger">❌ Error: ${error.message}</div>`;
                }
            };
            reader.readAsArrayBuffer(file);
        }
        
        function createSampleData() {
            const sampleCompanies = [
                ['Company Name', 'Role', 'Required Skills', 'Eligible Degrees', 'Country', 'Requirement Count'],
                ['TechCorp Inc', 'Software Engineer', 'Python, JavaScript, SQL', 'Computer Science', 'USA', 2],
                ['DataFlow Solutions', 'Data Scientist', 'Python, R, Machine Learning', 'Data Science', 'Canada', 1]
            ];
            
            const sampleCandidates = [
                ['Name', 'Country', 'Degree', 'Skills', 'Resume Link'],
                ['John Smith', 'USA', 'Computer Science', 'Python, JavaScript, SQL', 'https://drive.google.com/sample1'],
                ['Sarah Johnson', 'Canada', 'Data Science', 'Python, R, Machine Learning', 'https://drive.google.com/sample2']
            ];
            
            // Create Excel files
            const companiesWorkbook = XLSX.utils.book_new();
            const companiesSheet = XLSX.utils.aoa_to_sheet(sampleCompanies);
            XLSX.utils.book_append_sheet(companiesWorkbook, companiesSheet, 'Companies');
            
            const candidatesWorkbook = XLSX.utils.book_new();
            const candidatesSheet = XLSX.utils.aoa_to_sheet(sampleCandidates);
            XLSX.utils.book_append_sheet(candidatesWorkbook, candidatesSheet, 'Candidates');
            
            // Download files
            XLSX.writeFile(companiesWorkbook, 'sample_companies_test.xlsx');
            XLSX.writeFile(candidatesWorkbook, 'sample_candidates_test.xlsx');
            
            document.getElementById('sampleResult').innerHTML = 
                '<div class="alert alert-success">✅ Sample files created and downloaded!</div>';
        }
    </script>
</body>
</html> 